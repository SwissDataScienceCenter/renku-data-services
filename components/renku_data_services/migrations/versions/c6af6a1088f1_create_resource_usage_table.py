"""create resource_usage table

Revision ID: c6af6a1088f1
Revises: 9b18adb58e63
Create Date: 2026-01-20 16:58:55.442236

"""

import sqlalchemy as sa
from alembic import op

from renku_data_services.utils.sqlalchemy import ComputeCapacityType, DataSizeType, ULIDType

# revision identifiers, used by Alembic.
revision = "c6af6a1088f1"
down_revision = "9b18adb58e63"
branch_labels = None
depends_on = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table(
        "resource_requests_log",
        sa.Column("id", ULIDType(), server_default=sa.text("generate_ulid()"), nullable=False),
        sa.Column("cluster_id", sa.String(), nullable=True),
        sa.Column("namespace", sa.String(), nullable=False),
        sa.Column("name", sa.String(), nullable=False),
        sa.Column("uid", sa.String(), nullable=False),
        sa.Column("kind", sa.String(), nullable=False),
        sa.Column("phase", sa.String(), nullable=False),
        sa.Column("capture_date", sa.DateTime(timezone=True), nullable=False),
        sa.Column("user_id", sa.String(), nullable=True),
        sa.Column("project_id", ULIDType(), nullable=True),
        sa.Column("launcher_id", ULIDType(), nullable=True),
        sa.Column("resource_class_id", sa.Integer(), nullable=True),
        sa.Column("resource_pool_id", sa.Integer(), nullable=True),
        sa.Column("since", sa.DateTime(timezone=True), nullable=True),
        sa.Column("cpu_request", ComputeCapacityType(), nullable=True),
        sa.Column("memory_request", DataSizeType(), nullable=True),
        sa.Column("gpu_request", ComputeCapacityType(), nullable=True),
        sa.Column("disk_request", DataSizeType(), nullable=True),
        sa.PrimaryKeyConstraint("id"),
        schema="common",
    )
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_table("resource_requests_log", schema="common")
    # ### end Alembic commands ###
