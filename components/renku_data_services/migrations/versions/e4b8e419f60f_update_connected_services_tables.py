"""update connected services tables

* Addd use_pkce to oauth2_clients
* Add extra data to oauth2_connections

Revision ID: e4b8e419f60f
Revises: f34b87ddd954
Create Date: 2024-05-28 07:23:30.524107

"""
import sqlalchemy as sa
from alembic import op
from sqlalchemy.dialects import postgresql

# revision identifiers, used by Alembic.
revision = 'e4b8e419f60f'
down_revision = 'f34b87ddd954'
branch_labels = None
depends_on = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.add_column('oauth2_clients', sa.Column('use_pkce', sa.Boolean(), server_default=sa.text('false'), nullable=False), schema='connected_services')
    op.add_column('oauth2_connections', sa.Column('extra_data', sa.JSON().with_variant(postgresql.JSONB(astext_type=sa.Text()), 'postgresql'), nullable=True), schema='connected_services')
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_column('oauth2_connections', 'extra_data', schema='connected_services')
    op.drop_column('oauth2_clients', 'use_pkce', schema='connected_services')
    # ### end Alembic commands ###
